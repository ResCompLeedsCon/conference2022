{% capture times %}{% for day in site.data.schedule %}{% for timeslot in day.timeslots %}{% for slot in
timeslot.sessionIds %}{% for session in site.data.sessions %}{% if slot == session.id %}{% if session.hidden != true
%}{{session.id}}|{{ day.dateReadable }}|{{timeslot.startTime}}|{{timeslot.endTime}}{% if forloop.last %}^{% endif %}{%
endif %}{% endif %}{% if forloop.last %}^{% endif %}{% endfor %}{% endfor %}{% endfor %}{% endfor %}{% endcapture %}

{% assign s_times = times | split: "^" %}

{% capture new_times %}{% for day in site.data.schedule %}{% for item in s_times %}{% if item.size > 0 %}{% assign
current_id = item | split: "|" %}{% assign event_StartTimes = "" | split: "" %}{% assign event_EndTimes = "" | split: ""
%}{% for item2 in s_times %}{% assign iter2item = item2 | split: "|" %}{% if current_id[0] == iter2item[0] and
iter2item[1] == day.dateReadable %}{% assign event_StartTimes=iter2item[2] | concat: event_StartTimes %}{% assign
event_EndTimes=iter2item[3] | concat: event_EndTimes %}{% endif %}{% endfor %}{% if event_StartTimes.size > 0 %}
{{ current_id[0] }}|{{ day.dateReadable }}|{{event_StartTimes | sort_natural | first }}|{{event_EndTimes | sort_natural
| last}}^{% endif %}{% endif %}{% endfor %}{% endfor %}{% endcapture %}

{% assign new_times = new_times | split: "^" | uniq %}

<!-- Begin Schedule Section -->
<section id="schedule" class="schedule">
    <div class="content-wrapper">
        <div class="grid" data-masonry='{ "itemSelector": ".grid-item", "columnWidth": 10 }'>
            {% for session in site.data.sessions %}
            {% for item in new_times %}
            {% assign split_item = item | split: "|" %}
            {% assign s_item_0 = split_item[0] | to_integer %}
            {% if s_item_0 == session.id %}
            {% if session.hidden != true %}

            <div class="grid-item">
                <h5>{{ session.title }}</h5>
                <span class="text-body">Session time: {{ split_item[1] }} {{ split_item[2] }}-{{split_item[3] }}</span><br>
                <a href="{{ site.baseurl }}/schedule/#session-{{ session.id }}">Find the session in the schedule</a><br><br>
                {% if session.sessions %}
                {% for talk in session.sessions %}
                <h5>{{talk.talkTitle}}</h5>
                <strong>Talk time:</strong> {{talk.startTime}}-{{talk.endTime}} <br>
                <strong>Presenter:</strong> {{talk.speaker}} <br>
                
                <span class="text-body">{{ talk.description }}</span><br>
                <hr />
                {% endfor %}
                {% else %}
                <span class="text-body">{{ session.description }}</span><br>
                {% endif %}
            </div>
            {% endif %}
            {% endif %}
            {% endfor %}
            {% endfor %}
        </div>
    </div>
</section>
<!-- End Schedule Section -->
